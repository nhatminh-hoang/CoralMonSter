# =====================================================================
# CoralMonSter Configuration — CoralScapes Dataset (ViT-B)
# =====================================================================
#
# Paper: "CoralMonSter: Prompt-Free Segment Anything via Momentum
#          Distillation for Automated Coral Reef Monitoring"
#
# Hyperparameters from Table 1 (applied to CoralScapes evaluation)
#
# Dataset: CoralScapes — 2,075 images, 39 classes, high-resolution
#          Fine-grained taxonomy from 35 Red Sea dive sites
# =====================================================================

scenario_name: "coralscapes_vit_b"

# ── Data ─────────────────────────────────────────────────────────────
data:
  dataset: "coralscapes"
  root: "./data_storage/CoralScapes"
  image_size: 1024             # H = W = 1024
  num_classes: 39              # 38 benthic classes + background
  ignore_label: 255

  # ImageNet normalization (used by CoralScapes baselines)
  image_mean: [0.485, 0.456, 0.406]
  image_std:  [0.229, 0.224, 0.225]

# ── Model ────────────────────────────────────────────────────────────
model:
  type: "vit_b"
  checkpoint: "./checkpoints/vit_b_coralscop.pth"
  freeze_image_encoder: false
  num_classes: 39

# ── Optimizer (Table 1) ─────────────────────────────────────────────
optimizer:
  name: AdamW
  lr: 1.0e-4
  weight_decay: 0.01
  betas: [0.9, 0.999]

# ── Distillation (Table 1) ─────────────────────────────────────────
distillation:
  dice_weight: 1.5
  ce_weight: 1.5
  mask_kd_weight: 1.0
  token_kd_weight: 1.5

  momentum_start: 0.996
  momentum_end: 1.0

  teacher_temp_start: 0.04
  teacher_temp_end: 0.07
  student_temp: 0.1

  warmup_epochs: 1
  gt_points_per_class: 10

# ── Training ────────────────────────────────────────────────────────
training:
  max_epochs: 50
  batch_size: 2
  num_workers: 4
  log_interval: 10
  lr_warmup_epochs: 2
  grad_clip_norm: 1.0
  use_amp: true
